<h1>コース詳細</h1>

<table class="table">
 <tr>
   <td>コース名</td>
   <td><%= @course.name %></td>
 </tr>
 <tr>
  <td>住所</td>
  <td><%= @course.address %></td>
 </tr>
 <tr>
  <td>地図</td>
  <td><div id="map"></div></td>
 </tr>
</table>
<style>
#map{
  height:200px;
  width:300px;
}
</style>

<script type="text/javascript">
    function initMap() {

        var test = {lat: <%= @course.latitude %>, lng: <%= @course.longitude %>, };
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 15,
            center: test
        });
        var transitLayer = new google.maps.TransitLayer();
        transitLayer.setMap(map);

        var contentString = '住所：<%= @course.address %>';
        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        var marker = new google.maps.Marker({
            position:test,
            map: map,
            title: contentString
        });

        marker.addListener('click', function() {
            infowindow.open(map, marker);
        });
    }
</script>

<script async defer src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap">
</script>



<h2>レビュー一覧</h2>
 <table>
   <thead>
     <tr>
       <th>投稿日</th>
       <th>投稿者</th>
       <th>タイトル</th>
       <th>レビュー内容</th>
     </tr>
   </thead>
   <% @posts.each do |post| %>
   <tbody>
     <tr>
       <td><%= post.created_at.strftime("%Y/%m/%d") %></td>
       <td><%= post.user.name %></td>
       <td><%= post.title %></td>
       <td><%= post.body %></td>
     </tr>
   </tbody>
 </table>
  <% end %>

<h3>このコースのレビューを投稿する</h3>
<div>
 <%= form_with model: @post, local:true do |f| %>

 <%= f.attachment_field :post_images_images, multiple: true %>
 <%= f.text_field :title %>
 <%= f.text_area :body %>
 <%= f.hidden_field :course_id, value: @course.id %>
 <%= f.hidden_field :user_id, value: current_user.id %>
 <%= f.submit '投稿' %>

 <% end %>
</div>
